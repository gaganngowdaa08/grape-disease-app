<!DOCTYPE html>
<html lang="en">
<head><body>
    <h1 class="text-3xl font-semibold text-center mt-10 text-[var(--primary-theme)]">
        Welcome to Grape Disease Detection App
    </h1>
</body>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üçá Grape Disease Detector</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-theme: #6a0dad;
            --secondary-theme: #4b0082;
            --bg-light: #f8f9fa;
            --bg-dark: #1a1a2e;
            --card-light: #ffffff;
            --card-dark: #16213e;
        }

        body {
            font-family: 'Poppins', sans-serif;
            transition: all 0.3s ease;
        }

        .theme-purple {
            --primary-theme: #6a0dad;
            --secondary-theme: #4b0082;
        }

        .theme-green {
            --primary-theme: #2e8b57;
            --secondary-theme: #3cb371;
        }

        .theme-blue {
            --primary-theme: #4169e1;
            --secondary-theme: #1e90ff;
        }

        .gradient-bg {
            background: linear-gradient(135deg, var(--primary-theme) 0%, var(--secondary-theme) 100%);
        }

        .disease-card {
            border-left: 4px solid var(--primary-theme);
            transition: all 0.3s ease;
        }

        .disease-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        #imagePreview {
            max-height: 300px;
            object-fit: contain;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body class="bg-gray-50 theme-purple">
    <!-- Header -->
    <header class="sticky top-0 z-10 gradient-bg text-white shadow-lg">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <div class="flex items-center space-x-4">
                <span class="text-2xl font-bold">üçá GrapeCare</span>
                <div class="flex items-center space-x-2 bg-white/20 rounded-full p-1">
                    <span id="lang-en" class="lang-option cursor-pointer px-3 py-1 rounded-full bg-white text-[--primary-theme]">English</span>
                    <span id="lang-kn" class="lang-option cursor-pointer px-3 py-1 rounded-full">‡≤ï‡≤®‡≥ç‡≤®‡≤°</span>
                </div>
            </div>
            <div class="flex items-center space-x-3">
                <button id="theme-purple" class="theme-btn w-6 h-6 rounded-full bg-purple-700"></button>
                <button id="theme-green" class="theme-btn w-6 h-6 rounded-full bg-green-600"></button>
                <button id="theme-blue" class="theme-btn w-6 h-6 rounded-full bg-blue-600"></button>
                <button id="dark-toggle" class="p-2 rounded-full bg-white/20 hover:bg-white/30 transition">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z" />
                    </svg>
                </button>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8">
        <!-- Hero Section -->
        <section class="text-center mb-12">
            <h1 id="main-title" class="text-4xl font-bold text-[--primary-theme] mb-4">Grape Disease Detector</h1>
            <p id="subtitle" class="text-lg text-gray-600 dark:text-gray-300 max-w-2xl mx-auto">
                Upload an image of grape leaves to detect diseases and get treatment recommendations
            </p>
        </section>

        <!-- Upload Section -->
        <section class="max-w-2xl mx-auto bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden p-6 mb-8">
            <h2 id="upload-title" class="text-xl font-semibold text-[--secondary-theme] mb-4">Upload Grape Leaf Image</h2>
            <form id="upload-form" class="space-y-4">
                <div class="flex flex-col items-center justify-center border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-8 bg-gray-50 dark:bg-gray-700 transition hover:border-[--primary-theme]">
                    <input type="file" id="image-upload" accept="image/*" class="hidden" required>
                    <label for="image-upload" class="cursor-pointer flex flex-col items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-[--primary-theme]" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                        </svg>
                        <span id="upload-text" class="mt-2 text-sm text-gray-500 dark:text-gray-300">Click to select an image</span>
                    </label>
                </div>
                <img id="imagePreview" class="hidden w-full mt-4 rounded-lg">
                <button type="submit" id="analyze-btn" class="w-full gradient-bg hover:opacity-90 text-white font-medium rounded-lg py-3 px-4 transition duration-200 flex items-center justify-center">
                    <span id="analyze-text">Analyze Image</span>
                    <svg id="analyze-spinner" class="hidden animate-spin ml-2 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                </button>
            </form>
        </section>

        <!-- Results Section -->
        <section id="results-section" class="hidden max-w-2xl mx-auto bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden p-6 mb-8">
            <h2 id="results-title" class="text-xl font-semibold text-[--secondary-theme] mb-4">Analysis Results</h2>
            <div class="space-y-4">
                <div class="flex justify-between items-center">
                    <h3 id="disease-label" class="text-lg font-medium">Disease Detected:</h3>
                    <span id="confidence" class="px-3 py-1 bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-100 rounded-full text-sm font-medium">95% Confidence</span>
                </div>
                <p id="disease-name" class="text-2xl font-bold text-[--primary-theme]">Black Rot</p>
                <img id="analyzed-image" src="" alt="Analyzed grape leaf image" class="w-full rounded-lg border border-gray-200 dark:border-gray-600">
                
                <div class="mt-6">
                    <h4 id="treatment-title" class="font-medium text-lg mb-2">Recommended Treatment</h4>
                    <p id="treatment-tips" class="bg-blue-50 text-blue-900 dark:bg-blue-900 dark:text-blue-50 rounded-lg p-4">
                        Remove infected leaves and apply fungicide early in the season. Improve air circulation around plants.
                    </p>
                </div>
            </div>
        </section>

        <!-- Disease Information Cards -->
        <section class="max-w-6xl mx-auto mb-12">
            <h2 id="disease-info-title" class="text-2xl font-bold text-center text-[--secondary-theme] mb-8">Common Grape Diseases</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <!-- Black Rot Card -->
                <div class="disease-card bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
                    <div class="p-5">
                        <h3 id="disease1-title" class="text-xl font-semibold mb-2">Black Rot</h3>
                        <p id="disease1-desc" class="text-gray-600 dark:text-gray-300 mb-4">
                            Fungal disease causing dark spots on leaves and fruit rot. Common in warm, humid conditions.
                        </p>
                    </div>
                </div>

                <!-- ESCA Card -->
                <div class="disease-card bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
                    <div class="p-5">
                        <h3 id="disease2-title" class="text-xl font-semibold mb-2">ESCA</h3>
                        <p id="disease2-desc" class="text-gray-600 dark:text-gray-300 mb-4">
                            Complex disease causing leaf discoloration and wood decay. No chemical cure available.
                        </p>
                    </div>
                </div>

                <!-- Healthy Card -->
                <div class="disease-card bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
                    <div class="p-5">
                        <h3 id="disease3-title" class="text-xl font-semibold mb-2">Healthy</h3>
                        <p id="disease3-desc" class="text-gray-600 dark:text-gray-300 mb-4">
                            Healthy grape leaves should be vibrant green without spots or discoloration.
                        </p>
                    </div>
                </div>

                <!-- Leaf Blight Card -->
                <div class="disease-card bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
                    <div class="p-5">
                        <h3 id="disease4-title" class="text-xl font-semibold mb-2">Leaf Blight</h3>
                        <p id="disease4-desc" class="text-gray-600 dark:text-gray-300 mb-4">
                            Bacterial disease causing irregular brown patches on leaves and reduced fruit quality.
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Chatbot Section -->
        <section class="max-w-2xl mx-auto bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden mb-8">
            <div class="p-6">
                <h2 id="chat-title" class="text-xl font-semibold text-[--secondary-theme] mb-4">Ask GrapeCare Assistant</h2>
                <div id="chat-box" class="h-64 overflow-y-auto mb-4 space-y-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                    <div class="flex justify-start">
                        <div class="bg-[--primary-theme] text-white rounded-lg max-w-xs p-3">
                            <p id="welcome-message">Hello! I'm your grape disease assistant. How can I help you today?</p>
                        </div>
                    </div>
                </div>
                <div class="flex space-x-2">
                    <input id="user-input" type="text" placeholder="Type your question..." class="flex-1 border border-gray-300 dark:border-gray-600 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-[--primary-theme] dark:bg-gray-700">
                    <button id="send-btn" class="gradient-bg hover:opacity-90 text-white px-4 py-2 rounded-lg transition duration-200">
                        Send
                    </button>
                </div>
                <div class="mt-3 grid grid-cols-2 gap-2">
                    <button class="quick-question bg-gray-100 hover:bg-gray-200 dark:bg-gray-600 dark:hover:bg-gray-500 rounded-lg px-3 py-1 text-sm transition duration-200" data-question="black rot">
                        Black Rot
                    </button>
                    <button class="quick-question bg-gray-100 hover:bg-gray-200 dark:bg-gray-600 dark:hover:bg-gray-500 rounded-lg px-3 py-1 text-sm transition duration-200" data-question="esca">
                        ESCA
                    </button>
                    <button class="quick-question bg-gray-100 hover:bg-gray-200 dark:bg-gray-600 dark:hover:bg-gray-500 rounded-lg px-3 py-1 text-sm transition duration-200" data-question="healthy">
                        Healthy Grapes
                    </button>
                    <button class="quick-question bg-gray-100 hover:bg-gray-200 dark:bg-gray-600 dark:hover:bg-gray-500 rounded-lg px-3 py-1 text-sm transition duration-200" data-question="treatment">
                        Treatment Tips
                    </button>
                </div>
            </div>
        </section>
    </main>

    <footer class="gradient-bg text-white py-6 mt-12">
        <div class="container mx-auto px-4 text-center">
            <p id="footer-text" class="mb-2">¬© 2023 GrapeCare - Your Grape Disease Advisor</p>
            <p class="text-sm opacity-75">For educational purposes only | Consult an expert for serious plant health issues</p>
        </div>
    </footer>

    <script>
        // Language Content
        const translations = {
            en: {
                mainTitle: "Grape Disease Detector",
                subtitle: "Upload an image of grape leaves to detect diseases and get treatment recommendations",
                uploadTitle: "Upload Grape Leaf Image",
                uploadText: "Click to select an image",
                analyzeBtn: "Analyze Image",
                resultsTitle: "Analysis Results",
                diseaseLabel: "Disease Detected:",
                treatmentTitle: "Recommended Treatment",
                diseaseInfoTitle: "Common Grape Diseases",
                diseaseBlackRot: "Black Rot",
                diseaseEsca: "ESCA",
                diseaseHealthy: "Healthy",
                diseaseBlight: "Leaf Blight",
                chatTitle: "Ask GrapeCare Assistant",
                welcomeMessage: "Hello! I'm your grape disease assistant. How can I help you today?",
                footerText: "¬© 2023 GrapeCare - Your Grape Disease Advisor",
                quickQuestions: ["Black Rot", "ESCA", "Healthy Grapes", "Treatment Tips"],
                diseaseDescriptions: {
                    blackRot: "Fungal disease causing dark spots on leaves and fruit rot. Common in warm, humid conditions.",
                    esca: "Complex disease causing leaf discoloration and wood decay. No chemical cure available.",
                    healthy: "Healthy grape leaves should be vibrant green without spots or discoloration.",
                    blight: "Bacterial disease causing irregular brown patches on leaves and reduced fruit quality."
                },
                treatmentTips: {
                    blackRot: "Remove infected leaves and apply fungicide early in the season. Improve air circulation around plants.",
                    esca: "Prune infected vines and avoid water stress. No chemical cure available.",
                    healthy: "Your grapevine appears healthy. Maintain proper nutrition and watering to keep it thriving.",
                    blight: "Use protective sprays and remove affected leaves promptly. Avoid overhead watering."
                }
            },
            kn: {
                mainTitle: "‡≤¶‡≥ç‡≤∞‡≤æ‡≤ï‡≥ç‡≤∑‡≤ø ‡≤ï‡≤æ‡≤Ø‡≤ø‡≤≤‡≥Ü ‡≤™‡≤§‡≥ç‡≤§‡≥Ü‡≤ó‡≤æ‡≤∞",
                subtitle: "‡≤¶‡≥ç‡≤∞‡≤æ‡≤ï‡≥ç‡≤∑‡≤ø ‡≤é‡≤≤‡≥Ü‡≤ó‡≤≥ ‡≤ö‡≤ø‡≤§‡≥ç‡≤∞‡≤µ‡≤®‡≥ç‡≤®‡≥Å ‡≤Ö‡≤™‡≥ç‡≤≤‡≥ã‡≤°‡≥ç ‡≤Æ‡≤æ‡≤°‡≤ø ‡≤ï‡≤æ‡≤Ø‡≤ø‡≤≤‡≥Ü‡≤ó‡≤≥‡≤®‡≥ç‡≤®‡≥Å ‡≤™‡≤§‡≥ç‡≤§‡≥Ü‡≤π‡≤ö‡≥ç‡≤ö‡≤ø ‡≤ö‡≤ø‡≤ï‡≤ø‡≤§‡≥ç‡≤∏‡≥Ü ‡≤∂‡≤ø‡≤´‡≤æ‡≤∞‡≤∏‡≥Å‡≤ó‡≤≥‡≤®‡≥ç‡≤®‡≥Å ‡≤™‡≤°‡≥Ü‡≤Ø‡≤ø‡≤∞‡≤ø",
                uploadTitle: "‡≤¶‡≥ç‡≤∞‡≤æ‡≤ï‡≥ç‡≤∑‡≤ø ‡≤é‡≤≤‡≥Ü ‡≤ö‡≤ø‡≤§‡≥ç‡≤∞‡≤µ‡≤®‡≥ç‡≤®‡≥Å ‡≤Ö‡≤™‡≥ç‡≤≤‡≥ã‡≤°‡≥ç ‡≤Æ‡≤æ‡≤°‡≤ø",
                uploadText: "‡≤ö‡≤ø‡≤§‡≥ç‡≤∞‡≤µ‡≤®‡≥ç‡≤®‡≥Å ‡≤Ü‡≤Ø‡≥ç‡≤ï‡≥Ü ‡≤Æ‡≤æ‡≤°‡≤≤‡≥Å ‡≤ï‡≥ç‡≤≤‡≤ø‡≤ï‡≥ç ‡≤Æ‡≤æ‡≤°‡≤ø",
                analyzeBtn: "‡≤ö‡≤ø‡≤§‡≥ç‡≤∞‡≤µ‡≤®‡≥ç‡≤®‡≥Å ‡≤µ‡≤ø‡≤∂‡≥ç‡≤≤‡≥á‡≤∑‡≤ø‡≤∏‡≤ø",
                resultsTitle: "‡≤µ‡≤ø‡≤∂‡≥ç‡≤≤‡≥á‡≤∑‡≤£‡≥Ü ‡≤´‡≤≤‡≤ø‡≤§‡≤æ‡≤Ç‡≤∂‡≤ó‡≤≥‡≥Å",
                diseaseLabel: "‡≤ï‡≤æ‡≤Ø‡≤ø‡≤≤‡≥Ü ‡≤™‡≤§‡≥ç‡≤§‡≥Ü‡≤Ø‡≤æ‡≤ó‡≤ø‡≤¶‡≥Ü:",
                treatmentTitle: "‡≤∂‡≤ø‡≤´‡≤æ‡≤∞‡≤∏‡≥Å ‡≤Æ‡≤æ‡≤°‡≤ø‡≤¶ ‡≤ö‡≤ø‡≤ï‡≤ø‡≤§‡≥ç‡≤∏‡≥Ü",
                diseaseInfoTitle: "‡≤∏‡≤æ‡≤Æ‡≤æ‡≤®‡≥ç‡≤Ø ‡≤¶‡≥ç‡≤∞‡≤æ‡≤ï‡≥ç‡≤∑‡≤ø ‡≤ï‡≤æ‡≤Ø‡≤ø‡≤≤‡≥Ü‡≤ó‡≤≥‡≥Å",
                diseaseBlackRot: "‡≤ï‡≤™‡≥ç‡≤™‡≥Å ‡≤ï‡≥ä‡≤≥‡≥Ü",
                diseaseEsca: "‡≤é‡≤∏‡≥ç‡≤ï‡≤æ",
                diseaseHealthy: "‡≤Ü‡≤∞‡≥ã‡≤ó‡≥ç‡≤Ø‡≤ï‡≤∞",
                diseaseBlight: "‡≤¨‡≥ç‡≤≤‡≥à‡≤ü‡≥ç ‡≤é‡≤≤‡≥Ü",
                chatTitle: "GrapeCare ‡≤∏‡≤π‡≤æ‡≤Ø‡≤ï‡≤®‡≤®‡≥ç‡≤®‡≥Å ‡≤ï‡≥á‡≤≥‡≤ø",
                welcomeMessage: "‡≤®‡≤Æ‡≤∏‡≥ç‡≤ï‡≤æ‡≤∞! ‡≤®‡≤æ‡≤®‡≥Å ‡≤®‡≤ø‡≤Æ‡≥ç‡≤Æ ‡≤¶‡≥ç‡≤∞‡≤æ‡≤ï‡≥ç‡≤∑‡≤ø ‡≤ï‡≤æ‡≤Ø‡≤ø‡≤≤‡≥Ü ‡≤∏‡≤π‡≤æ‡≤Ø‡≤ï. ‡≤á‡≤Ç‡≤¶‡≥Å ‡≤®‡≤æ‡≤®‡≥Å ‡≤®‡≤ø‡≤Æ‡≤ó‡≥Ü ‡≤π‡≥á‡≤ó‡≥Ü ‡≤∏‡≤π‡≤æ‡≤Ø ‡≤Æ‡≤æ‡≤°‡≤¨‡≤π‡≥Å‡≤¶‡≥Å?",
                footerText: "¬© 2023 GrapeCare - ‡≤®‡≤ø‡≤Æ‡≥ç‡≤Æ ‡≤¶‡≥ç‡≤∞‡≤æ‡≤ï‡≥ç‡≤∑‡≤ø ‡≤ï‡≤æ‡≤Ø‡≤ø‡≤≤‡≥Ü ‡≤∏‡≤≤‡≤π‡≥Ü‡≤ó‡≤æ‡≤∞",
                quickQuestions: ["‡≤ï‡≤™‡≥ç‡≤™‡≥Å ‡≤ï‡≥ä‡≤≥‡≥Ü", "‡≤é‡≤∏‡≥ç‡≤ï‡≤æ", "‡≤Ü‡≤∞‡≥ã‡≤ó‡≥ç‡≤Ø‡≤ï‡≤∞ ‡≤¶‡≥ç‡≤∞‡≤æ‡≤ï‡≥ç‡≤∑‡≤ø", "‡≤ö‡≤ø‡≤ï‡≤ø‡≤§‡≥ç‡≤∏‡≥Ü ‡≤∏‡≤≤‡≤π‡≥Ü‡≤ó‡≤≥‡≥Å"],
                diseaseDescriptions: {
                    blackRot: "‡≤é‡≤≤‡≥Ü‡≤ó‡≤≥‡≥Å ‡≤Æ‡≤§‡≥ç‡≤§‡≥Å ‡≤π‡≤£‡≥ç‡≤£‡≥Å ‡≤ï‡≥ä‡≤≥‡≥Ü‡≤§‡≤¶ ‡≤Æ‡≥á‡≤≤‡≥Ü ‡≤ï‡≤™‡≥ç‡≤™‡≥Å ‡≤ï‡≤≤‡≥Ü‡≤ó‡≤≥‡≤®‡≥ç‡≤®‡≥Å ‡≤â‡≤Ç‡≤ü‡≥Å‡≤Æ‡≤æ‡≤°‡≥Å‡≤µ ‡≤´‡≤Ç‡≤ó‡≤≤‡≥ç ‡≤∞‡≥ã‡≤ó. ‡≤¨‡≥Ü‡≤ö‡≥ç‡≤ö‡≤ó‡≤ø‡≤®, ‡≤∂‡≥Ä‡≤§‡≤≤ ‡≤™‡≤∞‡≤ø‡≤∏‡≥ç‡≤•‡≤ø‡≤§‡≤ø‡≤ó‡≤≥‡≤≤‡≥ç‡≤≤‡≤ø ‡≤∏‡≤æ‡≤Æ‡≤æ‡≤®‡≥ç‡≤Ø.",
                    esca: "‡≤é‡≤≤‡≥Ü‡≤ó‡≤≥ ‡≤¨‡≤£‡≥ç‡≤£ ‡≤¨‡≤¶‡≤≤‡≤æ‡≤µ‡≤£‡≥Ü ‡≤Æ‡≤§‡≥ç‡≤§‡≥Å ‡≤Æ‡≤∞‡≤¶ ‡≤ï‡≥ä‡≤≥‡≥Ü‡≤§‡≤µ‡≤®‡≥ç‡≤®‡≥Å ‡≤â‡≤Ç‡≤ü‡≥Å‡≤Æ‡≤æ‡≤°‡≥Å‡≤µ ‡≤∏‡≤Ç‡≤ï‡≥Ä‡≤∞‡≥ç‡≤£ ‡≤∞‡≥ã‡≤ó. ‡≤∞‡≤æ‡≤∏‡≤æ‡≤Ø‡≤®‡≤ø‡≤ï ‡≤ö‡≤ø‡≤ï‡≤ø‡≤§‡≥ç‡≤∏‡≥Ü ‡≤≤‡≤≠‡≥ç‡≤Ø‡≤µ‡≤ø‡≤≤‡≥ç‡≤≤.",
                    healthy: "‡≤Ü‡≤∞‡≥ã‡≤ó‡≥ç‡≤Ø‡≤ï‡≤∞ ‡≤¶‡≥ç‡≤∞‡≤æ‡≤ï‡≥ç‡≤∑‡≤ø ‡≤é‡≤≤‡≥Ü‡≤ó‡≤≥‡≥Å ‡≤ï‡≤≤‡≥Ü‡≤ó‡≤≥‡≥Å ‡≤á‡≤≤‡≥ç‡≤≤‡≤¶‡≥Ü ‡≤π‡≤∞‡≤ø‡≤§‡≥ç‡≤µ‡≤π‡≤∞‡≤ø‡≤§‡≤µ‡≤æ‡≤ó‡≤ø ‡≤π‡≤∏‡≤ø‡≤∞‡≤æ‡≤ó‡≤ø‡≤∞‡≤¨‡≥á‡≤ï‡≥Å.",
                    blight: "‡≤é‡≤≤‡≥Ü‡≤ó‡≤≥ ‡≤Æ‡≥á‡≤≤‡≥Ü ‡≤Ö‡≤®‡≤ø‡≤Ø‡≤Æ‡≤ø‡≤§ ‡≤ï‡≤Ç‡≤¶‡≥Å ‡≤™‡≥ç‡≤Ø‡≤æ‡≤ö‡≥ç‡≤ó‡≤≥‡≥Å ‡≤Æ‡≤§‡≥ç‡≤§‡≥Å ‡≤π‡≤£‡≥ç‡≤£‡≤ø‡≤® ‡≤ó‡≥Å‡≤£‡≤Æ‡≤ü‡≥ç‡≤ü‡≤µ‡≤®‡≥ç‡≤®‡≥Å ‡≤ï‡≤°‡≤ø‡≤Æ‡≥Ü ‡≤Æ‡≤æ‡≤°‡≥Å‡≤µ ‡≤¨‡≥ç‡≤Ø‡≤æ‡≤ï‡≥ç‡≤ü‡≥Ä‡≤∞‡≤ø‡≤Ø‡≤æ‡≤¶ ‡≤∞‡≥ã‡≤ó."
                },
                treatmentTips: {
                    blackRot: "‡≤∏‡≥ã‡≤Ç‡≤ï‡≥Å ‡≤π‡≤∞‡≤°‡≤ø‡≤¶ ‡≤é‡≤≤‡≥Ü‡≤ó‡≤≥‡≤®‡≥ç‡≤®‡≥Å ‡≤§‡≥Ü‡≤ó‡≥Ü‡≤¶‡≥Å‡≤π‡≤æ‡≤ï‡≤ø ‡≤Æ‡≤§‡≥ç‡≤§‡≥Å ‡≤∏‡≥Ä‡≤ú‡≤®‡≥ç ‡≤Ü‡≤∞‡≤Ç‡≤≠‡≤¶‡≤≤‡≥ç‡≤≤‡≤ø ‡≤´‡≤Ç‡≤ó‡≤∏‡≥à‡≤°‡≥ç ‡≤Ö‡≤®‡≥ç‡≤®‡≥Å ‡≤Ö‡≤®‡≥ç‡≤µ‡≤Ø‡≤ø‡≤∏‡≤ø. ‡≤∏‡≤∏‡≥ç‡≤Ø‡≤ó‡≤≥ ‡≤∏‡≥Å‡≤§‡≥ç‡≤§‡≤≤‡≥Ç ‡≤µ‡≤æ‡≤Ø‡≥Å ‡≤∏‡≤Ç‡≤ö‡≤æ‡≤∞‡≤µ‡≤®‡≥ç‡≤®‡≥Å am√©liorate.",
                    esca: "‡≤∏‡≥ã‡≤Ç‡≤ï‡≥Å ‡≤¨‡≤ø‡≤¶‡≤ø‡≤∞‡≥Å‡≤ó‡≤≥‡≤®‡≥ç‡≤®‡≥Å ‡≤ï‡≤§‡≥ç‡≤§‡≤∞‡≤ø‡≤∏‡≤ø ‡≤Æ‡≤§‡≥ç‡≤§‡≥Å ‡≤®‡≥Ä‡≤∞‡≤ø‡≤® ‡≤í‡≤§‡≥ç‡≤§‡≤°‡≤µ‡≤®‡≥ç‡≤®‡≥Å ‡≤§‡≤™‡≥ç‡≤™‡≤ø‡≤∏‡≤ø. ‡≤∞‡≤æ‡≤∏‡≤æ‡≤Ø‡≤®‡≤ø‡≤ï ‡≤ö‡≤ø‡≤ï‡≤ø‡≤§‡≥ç‡≤∏‡≥Ü ‡≤≤‡≤≠‡≥ç‡≤Ø‡≤µ‡≤ø‡≤≤‡≥ç‡≤≤.",
                    healthy: "‡≤®‡≤ø‡≤Æ‡≥ç‡≤Æ ‡≤¶‡≥ç‡≤∞‡≤æ‡≤ï‡≥ç‡≤∑‡≤ø ‡≤¨‡≤≥‡≥ç‡≤≥‡≤ø ‡≤Ü‡≤∞‡≥ã‡≤ó‡≥ç‡≤Ø‡≤ï‡≤∞‡≤µ‡≤æ‡≤ó‡≤ø ‡≤ï‡≤æ‡≤£‡≥Å‡≤§‡≥ç‡≤§‡≤¶‡≥Ü. ‡≤Ö‡≤¶‡≤®‡≥ç‡≤®‡≥Å ‡≤â‡≤§‡≥ç‡≤§‡≤Æ‡≤µ‡≤æ‡≤ó‡≤ø‡≤∞‡≤ø‡≤∏‡≤ø‡≤ï‡≥ä‡≤≥‡≥ç‡≤≥‡≤≤‡≥Å ‡≤∏‡≤∞‡≤ø‡≤Ø‡≤æ‡≤¶ ‡≤™‡≥ã‡≤∑‡≤£‡≥Ü ‡≤Æ‡≤§‡≥ç‡≤§‡≥Å ‡≤®‡≥Ä‡≤∞‡≤®‡≥ç‡≤®‡≥Å ‡≤®‡≥Ä‡≤°‡≤ø.",
                    blight: "‡≤∞‡≤ï‡≥ç‡≤∑‡≤ï ‡≤∏‡≤ø‡≤Ç‡≤™‡≤°‡≤£‡≥Ü‡≤ó‡≤≥‡≤®‡≥ç‡≤®‡≥Å ‡≤¨‡≤≥‡≤∏‡≤ø ‡≤Æ‡≤§‡≥ç‡≤§‡≥Å ‡≤™‡≤∞‡≤ø‡≤£‡≤æ‡≤Æ ‡≤¨‡≥Ä‡≤∞‡≤ø‡≤¶ ‡≤é‡≤≤‡≥Ü‡≤ó‡≤≥‡≤®‡≥ç‡≤®‡≥Å ‡≤§‡≤ï‡≥ç‡≤∑‡≤£ ‡≤§‡≥Ü‡≤ó‡≥Ü‡≤¶‡≥Å‡≤π‡≤æ‡≤ï‡≤ø. ‡≤Æ‡≥á‡≤≤‡≤ø‡≤® ‡≤®‡≥Ä‡≤∞‡≤®‡≥ç‡≤®‡≥Å ‡≤§‡≤™‡≥ç‡≤™‡≤ø‡≤∏‡≤ø."
                }
            }
        };

        // Theme and Language Setup
        document.addEventListener('DOMContentLoaded', function() {
            // Dark Mode Toggle
            const darkToggle = document.getElementById('dark-toggle');
            darkToggle.addEventListener('click', () => {
                document.body.classList.toggle('dark-mode');
                localStorage.setItem('darkMode', document.body.classList.contains('dark-mode'));
            });

            // Check for saved dark mode preference
            if (localStorage.getItem('darkMode') === 'true') {
                document.body.classList.add('dark-mode');
            }

            // Theme Selector
            document.querySelectorAll('.theme-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.body.classList.remove('theme-purple', 'theme-green', 'theme-blue');
                    document.body.classList.add(this.id.replace('theme-', ''));
                    localStorage.setItem('selectedTheme', this.id.replace('theme-', ''));
                });
            });

            // Set saved theme
            const savedTheme = localStorage.getItem('selectedTheme') || 'purple';
            document.body.classList.add(`theme-${savedTheme}`);

            // Language Selector
            document.querySelectorAll('.lang-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.lang-option').forEach(opt => {
                        opt.classList.remove('bg-white', 'text-[--primary-theme]');
                        opt.classList.add('bg-transparent', 'text-white');
                    });
                    this.classList.add('bg-white', 'text-[--primary-theme]');
                    this.classList.remove('bg-transparent');
                    
                    const lang = this.id.replace('lang-', '');
                    localStorage.setItem('selectedLanguage', lang);
                    updateLanguage(lang);
                });
            });

            // Set saved language
            const savedLanguage = localStorage.getItem('selectedLanguage') || 'en';
            document.getElementById(`lang-${savedLanguage}`).click();

            // Image Preview
            document.getElementById('image-upload').addEventListener('change', function(e) {
                const reader = new FileReader();
                reader.onload = function() {
                    const output = document.getElementById('imagePreview');
                    output.src = reader.result;
                    output.classList.remove('hidden');
                };
                reader.readAsDataURL(e.target.files[0]);
            });

            // Chatbot functionality
            const chatBox = document.getElementById('chat-box');
            const userInput = document.getElementById('user-input');
            const sendBtn = document.getElementById('send-btn');

            function addChatMessage(message, isUser = false) {
                const bubbleClass = isUser ? 
                    'bg-[--secondary-theme] text-white rounded-lg rounded-br-none' : 
                    'bg-[--primary-theme] text-white rounded-lg rounded-bl-none';
                const alignClass = isUser ? 'justify-end' : 'justify-start';
                
                const messageDiv = document.createElement('div');
                messageDiv.className = `flex ${alignClass}`;
                messageDiv.innerHTML = `
                    <div class="${bubbleClass} max-w-xs p-3">
                        <p>${message}</p>
                    </div>
                `;
                chatBox.appendChild(messageDiv);
                chatBox.scrollTop = chatBox.scrollHeight;
            }

            function getBotResponse(message, lang) {
                message = message.toLowerCase();
                const langData = translations[lang];
                
                if (message.includes('black rot') || message.includes('‡≤ï‡≤™‡≥ç‡≤™‡≥Å ‡≤ï‡≥ä‡≤≥‡≥Ü')) {
                    return `${langData.diseaseBlackRot}: ${langData.treatmentTips.blackRot}`;
                } else if (message.includes('esca') || message.includes('‡≤é‡≤∏‡≥ç‡≤ï‡≤æ')) {
                    return `${langData.diseaseEsca}: ${langData.treatmentTips.esca}`;
                } else if (message.includes('healthy') || message.includes('‡≤Ü‡≤∞‡≥ã‡≤ó‡≥ç‡≤Ø‡≤ï‡≤∞')) {
                    return `${langData.diseaseHealthy}: ${langData.treatmentTips.healthy}`;
                } else if (message.includes('treatment') || message.includes('‡≤ö‡≤ø‡≤ï‡≤ø‡≤§‡≥ç‡≤∏‡≥Ü')) {
                    return Object.entries(langData.treatmentTips).map(([key, value]) => 
                        `<strong>${langData[`disease${key.charAt(0).toUpperCase() + key.slice(1)}`]}</strong>: ${value}`
                    ).join('<br><br>');
                } else if (message.includes('hello') || message.includes('hi') || message.includes('‡≤®‡≤Æ‡≤∏‡≥ç‡≤ï‡≤æ‡≤∞')) {
                    return lang === 'en' ? "Hello! How can I help with your grape plants today?" : "‡≤®‡≤Æ‡≤∏‡≥ç‡≤ï‡≤æ‡≤∞! ‡≤á‡≤Ç‡≤¶‡≥Å ‡≤®‡≤ø‡≤Æ‡≥ç‡≤Æ ‡≤¶‡≥ç‡≤∞‡≤æ‡≤ï‡≥ç‡≤∑‡≤ø ‡≤∏‡≤∏‡≥ç‡≤Ø‡≤ó‡≤≥ ‡≤¨‡≤ó‡≥ç‡≤ó‡≥Ü ‡≤®‡≤æ‡≤®‡≥Å ‡≤π‡≥á‡≤ó‡≥Ü ‡≤∏‡≤π‡≤æ‡≤Ø ‡≤Æ‡≤æ‡≤°‡≤¨‡≤π‡≥Å‡≤¶‡≥Å?";
                } else {
                    return lang === 'en' ? "I'm not sure about that. Try asking about grape diseases, treatments, or nutrition." : "‡≤®‡≤®‡≤ó‡≥Ü ‡≤Ö‡≤¶‡≤∞ ‡≤¨‡≤ó‡≥ç‡≤ó‡≥Ü ‡≤ñ‡≤ö‡≤ø‡≤§‡≤µ‡≤æ‡≤ó‡≤ø ‡≤§‡≤ø‡≤≥‡≤ø‡≤¶‡≤ø‡≤≤‡≥ç‡≤≤. ‡≤¶‡≥ç‡≤∞‡≤æ‡≤ï‡≥ç‡≤∑‡≤ø ‡≤ï‡≤æ‡≤Ø‡≤ø‡≤≤‡≥Ü‡≤ó‡≤≥‡≥Å, ‡≤ö‡≤ø‡≤ï‡≤ø‡≤§‡≥ç‡≤∏‡≥Ü‡≤ó‡≤≥‡≥Å ‡≤Ö‡≤•‡≤µ‡≤æ ‡≤™‡≥ã‡≤∑‡≤£‡≥Ü‡≤Ø ‡≤¨‡≤ó‡≥ç‡≤ó‡≥Ü ‡≤ï‡≥á‡≤≥‡≤ø.";
                }
            }

            sendBtn.addEventListener('click', function() {
                const message = userInput.value.trim();
                if (message !== '') {
                    addChatMessage(message, true);
                    const lang = localStorage.getItem('selectedLanguage') || 'en';
                    setTimeout(() => {
                        addChatMessage(getBotResponse(message, lang));
                    }, 500);
                    userInput.value = '';
                }
            });

            userInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendBtn.click();
                }
            });

            // Quick question buttons
            document.querySelectorAll('.quick-question').forEach(button => {
                button.addEventListener('click', function() {
                    const question = this.getAttribute('data-question');
                    userInput.value = question;
                    sendBtn.click();
                });
            });

            // Image Analysis
            document.getElementById('upload-form').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const fileInput = document.getElementById('image-upload');
                if (!fileInput.files.length) {
                    alert(translations[localStorage.getItem('selectedLanguage') || 'en'].uploadText);
                    return;
                }

                const analyzeBtn = document.getElementById('analyze-btn');
                const analyzeText = document.getElementById('analyze-text');
                const spinner = document.getElementById('analyze-spinner');

                analyzeText.textContent = translations[localStorage.getItem('selectedLanguage') || 'en'].analyzeBtn + '...';
                spinner.classList.remove('hidden');
                analyzeBtn.disabled = true;

                try {
                    const formData = new FormData();
                    formData.append('image', fileInput.files[0]);
                    
                    const response = await fetch('/predict', {
                        method: 'POST',
                        body: formData
                    });
                    
                    if (!response.ok) throw new Error('Analysis failed');
                    
                    const result = await response.json();
                    
                    // Update UI with results
                    document.getElementById('disease-name').textContent = result.prediction;
                    document.getElementById('confidence').textContent = `${result.confidence}% Confidence`;
                    document.getElementById('treatment-tips').textContent = result.treatment;
                    document.getElementById('analyzed-image').src = result.image_url;
                    
                    document.getElementById('results-section').classList.remove('hidden');
                    document.getElementById('results-section').scrollIntoView({ behavior: 'smooth' });
                    
                } catch (error) {
                    console.error('Error:', error);
                    alert('Error analyzing image. Please try again.');
                } finally {
                    analyzeText.textContent = translations[localStorage.getItem('selectedLanguage') || 'en'].analyzeBtn;
                    spinner.classList.add('hidden');
                    analyzeBtn.disabled = false;
                }
            });
        });

        // Update all text content based on selected language
        function updateLanguage(lang) {
            const langData = translations[lang];
            
            // Update main elements
            document.getElementById('main-title').textContent = langData.mainTitle;
            document.getElementById('subtitle').textContent = langData.subtitle;
            document.getElementById('upload-title').textContent = langData.uploadTitle;
            document.getElementById('upload-text').textContent = langData.uploadText;
            document.getElementById('analyze-text').textContent = langData.analyzeBtn;
            document.getElementById('results-title').textContent = langData.resultsTitle;
            document.getElementById('disease-label').textContent = langData.diseaseLabel;
            document.getElementById('treatment-title').textContent = langData.treatmentTitle;
            document.getElementById('disease-info-title').textContent = langData.diseaseInfoTitle;
            document.getElementById('chat-title').textContent = langData.chatTitle;
            document.getElementById('footer-text').textContent = langData.footerText;
            
            // Update quick questions
            const quickQuestions = document.querySelectorAll('.quick-question');
            quickQuestions.forEach((button, index) => {
                button.textContent = langData.quickQuestions[index];
            });
            
            // Update disease cards
            document.getElementById('disease1-title').textContent = langData.diseaseBlackRot;
            document.getElementById('disease2-title').textContent = langData.diseaseEsca;
            document.getElementById('disease3-title').textContent = langData.diseaseHealthy;
            document.getElementById('disease4-title').textContent = langData.diseaseBlight;
            
            document.getElementById('disease1-desc').textContent = langData.diseaseDescriptions.blackRot;
            document.getElementById('disease2-desc').textContent = langData.diseaseDescriptions.esca;
            document.getElementById('disease3-desc').textContent = langData.diseaseDescriptions.healthy;
            document.getElementById('disease4-desc').textContent = langData.diseaseDescriptions.blight;
            
            // Update welcome message in chat
            document.getElementById('welcome-message').textContent = langData.welcomeMessage;
        }
    </script>
</body>
</html>